---
layout: task
title: Tools for task planning and execution
category: lab
lab: 3
task: 2
brief: 
---

This section contains information about various tools for task planning and execution.








# Running the simulated system

### Location

 * launch file: `velma_system.launch` in package `velma_common`

### Command

```bash
roslaunch velma_common velma_system.launch
```

### Description

The launch file runs the whole system with robot and environment simulated in Gazebo.

TODO









# Running initialization and homing procedure

### Location

 * script: `initialize_robot.py` in package `velma_task_cs_ros_interface`

### Command

```bash
rosrun velma_task_cs_ros_interface initialize_robot.py
```

### Description

After every startup, the robot have to be initialized with `initialize_robot.py` script.
The script changes state of hardware controllers of motors to *enabled*. Then, some motors that
require homing are homed.








# Test scripts

### Location

Scripts in package `velma_task_cs_ros_interface`:
 * `test_all.py`
 * `test_head.py`
 * `test_head_complex.py`
 * `test_safe_col.py`
 * `test_jimp.py`
 * `test_grippers.py`
 * `test_jimp_planning.py`
 * `test_jimp_planning_attached.py`
 * `test_cimp_pose.py`
 * `test_cimp_tool.py`
 * `test_cimp_imp.py`

### Command

```bash
rosrun velma_task_cs_ros_interface <script_name>
```

### Description

The scripts test some basic performance of the whole system:
 * `test_head.py` - movement of head only,
 * `test_head_complex.py` - movement of head combined with movement of arms and torso; tests of behavior of head controller in situations of fault and behavior switch,
 * `test_safe_col.py` - tests for behavior for self collision avoidance,
 * `test_jimp.py` - simple movement of arms and torso,
 * `test_grippers.py` - simple movement of gripper fingers,
 * `test_jimp_planning.py` - movement of arms and torso using trajectory generated by planner,
 * `test_jimp_planning_attached.py` - planning movement of arms and torso with virtual object attached to gripper,
 * `test_cimp_pose.py` - simple movements of end effectors using control in 6-DOF task space,
 * `test_cimp_tool.py` - changing the tool frame of end effectors,
 * `test_cimp_imp.py` - changing the impedance of end effectors,
 * `test_all.py` - runs all tests in sequence.








# Planner for Velma

### Location

 * launch file for Velma: `velma_planner.launch` in package `velma_ros_plugin`

### Command

```bash
roslaunch velma_ros_plugin velma_planner.launch
```

### Description

This launch file runs ROS node with geometric planner for Velma.








# Visual markers tracking

### Location

 * launch file: `ar_track_kinect_50.launch` in package `velma_common`

### Command

```bash
roslaunch velma_common ar_track_kinect_50.launch
```

### Description
TODO







# Running online octomap server

### Location

 * launch file: `octomap_offline_server.launch` in package `velma_common`

### Command

```bash
roslaunch velma_common octomap_offline_server.launch
```
TODO

### Description
TODO








# Running online octomap server

### Location

 * launch file: `octomap_server.launch` in package `velma_common`

### Command

```bash
roslaunch velma_common octomap_server.launch
```

### Description
TODO










# Moving the end effectors using interactive markers

### Location

 * script: `int_markers_cimp` in package `velma_common`

### Command

```bash
rosrun velma_common int_markers_cimp
```

### Description

This script publishes interactive 6 DOF markers that can be used inside *rviz*  to move around the end effectors of Velma.
ROS topics for interactive markers are:
 * for the right end effector: `/int_markers_cimp_right/update`
 * for the left end effector: `/int_markers_cimp_left/update`

![]({{site.baseurl}}/public/img/velma_int_markers_cimp.png)






# Creating a snapshot of simulation state

### Location

 * script: `create_state_snapshot` in package `rcprg_gazebo_utils`

### Example command

```bash
rosrun rcprg_gazebo_utils create_state_snapshot
```

### Description

This script creates snapshot of the current state of all joints in simulation and saves it to file `state_snapshot.txt` in the current working directory.
The snapshot can be restored, together with saved world using argument `state_snapshot` in launch
file `velma_system.launch` in package `velma_common` or in launch file `velma_gazebo_re.launch` in package `velma_sim_gazebo`.






# Moving an object in Gazebo using interactive 6 DOF marker

### Location

 * script: `gazebo_move_object` in package `rcprg_gazebo_utils`

### Example command

```bash
rosrun rcprg_gazebo_utils gazebo_move_object jar_01::link
```

### Description
TODO

